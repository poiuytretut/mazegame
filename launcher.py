# launcher.py - –ª–∞—É–Ω—á–µ—Ä –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –∏–≥—Ä—ã
import os
import sys
import subprocess

def clear():
    """–û—á–∏—â–∞–µ—Ç –∫–æ–Ω—Å–æ–ª—å"""
    os.system('cls' if os.name == 'nt' else 'clear')

def get_script_dir():
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç"""
    return os.path.dirname(os.path.abspath(__file__))

def show_menu():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    while True:
        clear()
        print("=== –õ–ê–ë–ò–†–ò–ù–¢ ===")
        print()
        print("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
        print("‚ïë         –í–´–ë–ï–†–ò–¢–ï –†–ï–ñ–ò–ú       ‚ïë")
        print("‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£")
        print("‚ïë                              ‚ïë")
        print("‚ïë  1. üéÆ –ò–ì–†–ê–¢–¨ (Play)         ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïë  2. üìπ –î–ï–ú–û (Demo)           ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïë  3. ‚ùå –í–´–•–û–î (Exit)          ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")
        print()
        print("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º (1-3):")
        
        choice = input().strip()
        
        if choice == '1':
            return 'play'
        elif choice == '2':
            return 'demo'
        elif choice == '3':
            return 'exit'
        else:
            print("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ 1, 2 –∏–ª–∏ 3")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")

def run_game(mode):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º"""
    clear()
    
    script_dir = get_script_dir()
    
    if mode == 'play':
        game_file = os.path.join(script_dir, "main2.py")
        print("–ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞...")
        print(f"–§–∞–π–ª: {game_file}")
        print()
        
        if not os.path.exists(game_file):
            print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª {game_file} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ main2.py –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ —á—Ç–æ –∏ –ª–∞—É–Ω—á–µ—Ä")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
            return
        
        try:
            # –ó–∞–ø—É—Å–∫–∞–µ–º main2.py –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            subprocess.run([sys.executable, game_file], cwd=script_dir, check=True)
        except subprocess.CalledProcessError as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã: {e}")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
        except Exception as e:
            print(f"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
    
    elif mode == 'demo':
        demo_file = os.path.join(script_dir, "demo_mode.py")
        print("–ó–∞–ø—É—Å–∫ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞...")
        print(f"–§–∞–π–ª: {demo_file}")
        print()
        
        if not os.path.exists(demo_file):
            print(f"–û—à–∏–±–∫–∞: —Ñ–∞–π–ª {demo_file} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ demo_mode.py –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ —á—Ç–æ –∏ –ª–∞—É–Ω—á–µ—Ä")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
            return
        
        try:
            # –ó–∞–ø—É—Å–∫–∞–µ–º demo_mode.py –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            subprocess.run([sys.executable, demo_file], cwd=script_dir, check=True)
        except subprocess.CalledProcessError as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –¥–µ–º–æ: {e}")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")
        except Exception as e:
            print(f"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")

def show_credits():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ"""
    clear()
    print("=== –û –ü–†–û–ì–†–ê–ú–ú–ï ===")
    print()
    print("3D –õ–ê–ë–ò–†–ò–ù–¢")
    print("–ò–≥—Ä–∞ —Å raycasting-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º")
    print()
    print("–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:")
    print("‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –ª–∞–±–∏—Ä–∏–Ω—Ç–æ–≤")
    print("‚Ä¢ 5 —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏")
    print("‚Ä¢ 3D-–≥—Ä–∞—Ñ–∏–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏")
    print("‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ (–¥–µ–º–æ)")
    print("‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –¥–∞–º–ø–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏")
    print()
    print("–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–≥—Ä–µ:")
    print("W/S - –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø–µ—Ä–µ–¥/–Ω–∞–∑–∞–¥")
    print("A/D - –ø–æ–≤–æ—Ä–æ—Ç –∫–∞–º–µ—Ä—ã")
    print("Z/C - —Å—Ç—Ä–µ–π—Ñ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ")
    print("I - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞")
    print("R - —Ä–µ—Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã")
    print("L - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–º–ø–∞")
    print("Q - –≤—ã—Ö–æ–¥")
    print()
    input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é...")

def check_required_files():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤"""
    script_dir = get_script_dir()
    required_files = ["main2.py", "maze_generator.py", "player.py", "raycasting.py", "config.py"]
    
    missing_files = []
    for file in required_files:
        if not os.path.exists(os.path.join(script_dir, file)):
            missing_files.append(file)
    
    return missing_files

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ª–∞—É–Ω—á–µ—Ä–∞"""
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
    missing_files = check_required_files()
    if missing_files:
        clear()
        print("=== –û–®–ò–ë–ö–ê ===")
        print()
        print("–ù–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã:")
        for file in missing_files:
            print(f"‚Ä¢ {file}")
        print()
        print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ —Å –ª–∞—É–Ω—á–µ—Ä–æ–º:")
        print(f"–¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: {get_script_dir()}")
        print()
        input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
        return
    
    while True:
        clear()
        print("=== –õ–ê–ë–ò–†–ò–ù–¢ ===")
        print()
        print("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó")
        print("‚ïë         –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ         ‚ïë")
        print("‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£")
        print("‚ïë                              ‚ïë")
        print("‚ïë  1.   –ù–ê–ß–ê–¢–¨ –ò–ì–†–£            ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïë  2.   –î–ï–ú–û-–†–ï–ñ–ò–ú             ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïë  3.   –û –ü–†–û–ì–†–ê–ú–ú–ï            ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïë  4.   –í–´–•–û–î                  ‚ïë")
        print("‚ïë                              ‚ïë")
        print("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù")
        print()
        print(f"–¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: {get_script_dir()}")
        print()
        print("–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é (1-4):")
        
        choice = input().strip()
        
        if choice == '1':
            run_game('play')
        elif choice == '2':
            run_game('demo')
        elif choice == '3':
            show_credits()
        elif choice == '4':
            clear()
            print("–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É! –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        else:
            print("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é –æ—Ç 1 –¥–æ 4")
            input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        clear()
        print("–í—ã—Ö–æ–¥ –∏–∑ –∏–≥—Ä—ã...")
    except Exception as e:
        print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
        input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")